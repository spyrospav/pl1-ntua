Java ztalloc based on nickie's BFS solver
